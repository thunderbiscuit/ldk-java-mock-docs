<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en"><head>
    <title>Persist </title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="dc.created" content="2020-03-25">
    <link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
    <link rel="stylesheet" type="text/css" href="../../../dokka-javadoc-stylesheet.css" title="Style">
    <link rel="stylesheet" type="text/css" href="../../../jquery/jquery-ui.css" title="Style">
    <script type="text/javascript" src="../../../jquery/jquery-3.3.1.js"></script>
    <script type="text/javascript" src="../../../jquery/jquery-migrate-3.0.1.js"></script>
    <script type="text/javascript" src="../../../jquery/jquery-ui.js"></script>

    <script type="text/javascript" src="../../../search.js"></script>
    <script async type="text/javascript" src="../../../module-search-index.js"></script>
    <script async type="text/javascript" src="../../../package-search-index.js"></script>
    <script async type="text/javascript" src="../../../type-search-index.js"></script>
    <script async type="text/javascript" src="../../../member-search-index.js"></script>
    <script async type="text/javascript" src="../../../tag-search-index.js"></script>
</head><body>
<script type="text/javascript">
var pathtoroot = "../../../";
</script>
<noscript>
    <div>JavaScript is disabled on your browser.</div>
</noscript><header role="banner">
    <nav role="navigation">
        <div class="fixedNav">
            <!-- ========= START OF TOP NAVBAR ======= -->
            <div class="topNav"><a id="navbar.top">
                <!--   -->
            </a>
                <div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a>
                </div>
                <a id="navbar.top.firstrow">
                    <!--   -->
                </a>
                <ul class="navList" title="Navigation">
    <li><a href="../../../index.html">Overview</a></li>
    
    <li><a href="package-summary.html">Package</a></li>
    
    <li class="navBarCell1Rev">Class</li>
    
    <li><a href="package-tree.html">Tree</a></li>
    
    <li><a href="../../../deprecated.html">Deprecated</a></li>
    <li><a href="../../../index-files/index-1.html">Index</a></li>
    <li>Help</li>
</ul></div>
            <div class="subNav">
<ul class="navList" id="allclasses_navbar_top" style="display: block;">
    <li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>

<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" class="ui-autocomplete-input" autocomplete="off" placeholder="Search">
<input type="reset" id="reset" value="reset">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div><!-- ========= END OF TOP NAVBAR ========= -->
        </div>
        <div class="navPadding">&nbsp;</div>
        <script type="text/javascript"><!--
        $('.navPadding').css('padding-top', $('.fixedNav').css("height"));
        //-->
        </script>
    </nav>
</header>

<main role="main">
    <div class="header">
        <div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html"></a></div>
        <h2 title="Class Persist" class="title">Class Persist</h2>
    </div>
    <div class="contentContainer">
        <!-- <ul class="inheritance">
            <li>java.lang.Object</li>
            <li>
                <ul class="inheritance">
                    <li>adaptation.Adaptation</li>
                </ul>
            </li>
        </ul> TODO inheritance tree -->
        <div class="description">
            <ul class="blockList">
                <li class="blockList">
                    
                    <dl>
                        <dt>All Implemented Interfaces:</dt>
                        <dd>
                            
                        </dd>
                    </dl>
                    
                    <hr>
                    <pre class="wrap-overflow">

public class <span class="typeNameLabel"><a href=Persist.html>Persist</a></span>
extends CommonBase
                    </pre>
                    <div class="block"><p>`Persist` defines behavior for persisting channel monitors: this could mean writing once to disk, and/or uploading to one or more backup services. Each method can return three possible values: If persistence (including any relevant `fsync()` calls) happens immediately, the implementation should return `Ok(())`, indicating normal channel operation should continue. If persistence happens asynchronously, implementations should first ensure the [`ChannelMonitor`] or [`ChannelMonitorUpdate`] are written durably to disk, and then return `Err(ChannelMonitorUpdateErr::TemporaryFailure)` while the update continues in the background. Once the update completes, [`ChainMonitor::channel_monitor_updated`] should be called with the corresponding [`MonitorUpdateId`]. Note that unlike the direct [`chain::Watch`] interface, [`ChainMonitor::channel_monitor_updated`] must be called once for *each* update which occurs. If persistence fails for some reason, implementations should return `Err(ChannelMonitorUpdateErr::PermanentFailure)`, in which case the channel will likely be closed without broadcasting the latest state. See [`ChannelMonitorUpdateErr::PermanentFailure`] for more details.</p></div>
                </li>
            </ul>
        </div>
        <div class="summary">
            <ul class="blockList">
                <li class="blockList">
                <!-- ======== NESTED CLASS SUMMARY ======== -->
                    
                    <section role="region">
                        <ul class="blockList">
                            <li class="blockList"><a id="nested.class.summary">
                                <!--   -->
                            </a>
                                <h3>Nested Class Summary</h3>
                                <div class="memberSummary">
                                    <table>
                                        <caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
                                        <tr>
                                            <th class="colFirst" scope="col">Modifier and Type</th>
                                            <th class="colSecond" scope="col">Class</th>
                                            <th class="colLast" scope="col">Description</th>
                                        </tr>
                                        
                                        <tr class="altColor">
                                            <td class="colFirst"><code>public interface</code></td>
                                            <th class="colSecond" scope="row"><code><a href="Persist.PersistInterface.html">Persist.PersistInterface</a></span></code>
                                            </th>
                                            <td class="colLast"></td>
                                        </tr>
                                        
                                    </table>
                                </div>
                            </li>
                        </ul>
                    </section>
                    
                    <!-- =========== FIELD SUMMARY =========== -->
                    
                    <section role="region">
                        <ul class="blockList">
                            <li class="blockList"><a id="field.summary">
                                <!--   -->
                            </a>
                                <h3>Field Summary</h3>
                                <div class="memberSummary">
                                    <table>
                                        <caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
                                        <tr>
                                            <th class="colFirst" scope="col">Modifier and Type</th>
                                            <th class="colSecond" scope="col">Field</th>
                                            <th class="colLast" scope="col">Description</th>
                                        </tr>
                                        
                                    </table>
                                </div>
                            </li>
                        </ul>
                    </section>
                    
                    <!-- ======== CONSTRUCTOR SUMMARY ======== -->
                    
                    <section role="region">
                        <ul class="blockList">
                            <li class="blockList"><a id="constructor.summary">
                                <!--   -->
                            </a>
                                <h3>Constructor Summary</h3>
                                <div class="memberSummary">
                                    <table>
                                        <caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
                                        <tbody>
                                        <tr>
                                            <th class="colFirst" scope="col">Constructor</th>
                                            <th class="colLast" scope="col">Description</th>
                                        </tr>

                                        

                                        </tbody>
                                    </table>
                                </div>
                            </li>
                        </ul>
                    </section>
                    
                    <!-- =========== ENUM CONSTANT SUMMARY =========== -->
                    
                    <section role="region">
                        <ul class="blockList">
                            <li class="blockList"><a id="enum.constant.summary">
                                <!--   -->
                            </a>
                                <h3>Enum Constant Summary</h3>
                                <table class="memberSummary">
                                    <caption><span>Enum Constants</span><span class="tabEnd">&nbsp;</span></caption>
                                    <tr>
                                        <th class="colFirst" scope="col">Enum Constant</th>
                                        <th class="colLast" scope="col">Description</th>
                                    </tr>
                                    
                                </table>
                            </li>
                        </ul>
                    </section>
                    
                    <!-- ========== METHOD SUMMARY =========== -->
                    
                    <section role="region">
                        <ul class="blockList">
                            <li class="blockList"><a id="method.summary">
                                <!--   -->
                            </a>
                                <h3>Method Summary</h3>
                                <div class="memberSummary">
                                    <div role="tablist" aria-orientation="horizontal">
                                        <button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button>
                                        <!-- TODO: Instance and Concrete Methods #1118 -->
                                    </div>
                                    <div id="memberSummary_tabpanel" role="tabpanel">
                                    <table aria-labelledby="t0">
                                        <tr>
                                            <th class="colFirst" scope="col">Modifier and Type</th>
                                            <th class="colSecond" scope="col">Method</th>
                                            <th class="colLast" scope="col">Description</th>
                                        </tr>
                                        
                                        <tr id="i0" class="altColor">
                                            <td class="colFirst"><code>static <a href=Persist.html>Persist</a></code>
                                            </td>
                                            <th class="colSecond" scope="row"><code><a href=Persist.html#new_impl(Persist.PersistInterface)>new_impl</a>(<a href=Persist.PersistInterface.html>Persist.PersistInterface</a> arg) </code>
                                            </th>
                                            <td class="colLast"></td>
                                        </tr>
                                        
                                        <tr id="i1" class="rowColor">
                                            <td class="colFirst"><code><a href=Result_NoneChannelMonitorUpdateErrZ.html>Result_NoneChannelMonitorUpdateErrZ</a></code>
                                            </td>
                                            <th class="colSecond" scope="row"><code><a href=Persist.html#persist_new_channel(OutPoint,ChannelMonitor,MonitorUpdateId)>persist_new_channel</a>(<a href=OutPoint.html>OutPoint</a> channel_id, <a href=ChannelMonitor.html>ChannelMonitor</a> data, <a href=MonitorUpdateId.html>MonitorUpdateId</a> update_id) </code>
                                            </th>
                                            <td class="colLast">Persist a new channel's data in response to a [`chain::Watch::watch_channel`] call.</td>
                                        </tr>
                                        
                                        <tr id="i2" class="altColor">
                                            <td class="colFirst"><code><a href=Result_NoneChannelMonitorUpdateErrZ.html>Result_NoneChannelMonitorUpdateErrZ</a></code>
                                            </td>
                                            <th class="colSecond" scope="row"><code><a href=Persist.html#update_persisted_channel(OutPoint,ChannelMonitorUpdate,ChannelMonitor,MonitorUpdateId)>update_persisted_channel</a>(<a href=OutPoint.html>OutPoint</a> channel_id, @<a href=https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nullable.html>Nullable</a>() <a href=ChannelMonitorUpdate.html>ChannelMonitorUpdate</a> update, <a href=ChannelMonitor.html>ChannelMonitor</a> data, <a href=MonitorUpdateId.html>MonitorUpdateId</a> update_id) </code>
                                            </th>
                                            <td class="colLast">Update one channel's data.</td>
                                        </tr>
                                        
                                        </tbody>
                                    </table>
                                </div>
                                <ul class="blockList">
                                
                                    <li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
                                        <!--   -->
                                    </a>
                                        <h3>Methods inherited from class&nbsp;java.lang.Object</h3>
                                        <code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString,
                                            wait, wait, wait</code></li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                    
                </li>
            </ul>
        </div>
        <div class="details">
            <ul class="blockList">
                <li class="blockList">
                    <!-- ========= CONSTRUCTOR DETAIL ======== -->
                    
                    <section role="region">
                        <ul class="blockList">
                            <li class="blockList"><a id="constructor.detail">
                                <!--   -->
                            </a>
                                <h3>Constructor Detail</h3>
                                
                            </li>
                        </ul>
                    </section>
                    
                    <!-- ============ METHOD DETAIL ========== -->
                    
                    <section role="region">
                        <ul class="blockList">
                            <li class="blockList"><a id="method.detail">
                                <!--   -->
                            </a>
                                <h3>Method Detail</h3>
                                
                                <a id="new_impl(Persist.PersistInterface)">
                                    <!--   -->
                                </a>
                                <ul class=
                                              "blockList"
                                          >
                                    <li class="blockList">
                                        <h4>new_impl</h4>
                                        <pre class="methodSignature"> static <a href=Persist.html>Persist</a> <a href=Persist.html#new_impl(Persist.PersistInterface)>new_impl</a>(<a href=Persist.PersistInterface.html>Persist.PersistInterface</a> arg)</pre>
                                        <div class="block"></div>
                                        
                                        <!-- TODO missing return annotation -->
                                    </li>
                                </ul>
                                
                                <a id="persist_new_channel(OutPoint,ChannelMonitor,MonitorUpdateId)">
                                    <!--   -->
                                </a>
                                <ul class=
                                              "blockList"
                                          >
                                    <li class="blockList">
                                        <h4>persist_new_channel</h4>
                                        <pre class="methodSignature"> <a href=Result_NoneChannelMonitorUpdateErrZ.html>Result_NoneChannelMonitorUpdateErrZ</a> <a href=Persist.html#persist_new_channel(OutPoint,ChannelMonitor,MonitorUpdateId)>persist_new_channel</a>(<a href=OutPoint.html>OutPoint</a> channel_id, <a href=ChannelMonitor.html>ChannelMonitor</a> data, <a href=MonitorUpdateId.html>MonitorUpdateId</a> update_id)</pre>
                                        <div class="block"><p>Persist a new channel's data in response to a [`chain::Watch::watch_channel`] call. This is called by [`ChannelManager`] for new channels, or may be called directly, e.g. on startup. The data can be stored any way you want, but the identifier provided by LDK is the channel's outpoint (and it is up to you to maintain a correct mapping between the outpoint and the stored channel data). Note that you **must** persist every new monitor to disk. The `update_id` is used to identify this call to [`ChainMonitor::channel_monitor_updated`], if you return [`ChannelMonitorUpdateErr::TemporaryFailure`]. See [`Writeable::write`] on [`ChannelMonitor`] for writing out a `ChannelMonitor` and [`ChannelMonitorUpdateErr`] for requirements when returning errors. [`ChannelManager`]: crate::ln::channelmanager::ChannelManager [`Writeable::write`]: crate::util::ser::Writeable::write</p></div>
                                        
                                        <!-- TODO missing return annotation -->
                                    </li>
                                </ul>
                                
                                <a id="update_persisted_channel(OutPoint,ChannelMonitorUpdate,ChannelMonitor,MonitorUpdateId)">
                                    <!--   -->
                                </a>
                                <ul class=
                                              "blockListLast"
                                          >
                                    <li class="blockList">
                                        <h4>update_persisted_channel</h4>
                                        <pre class="methodSignature"> <a href=Result_NoneChannelMonitorUpdateErrZ.html>Result_NoneChannelMonitorUpdateErrZ</a> <a href=Persist.html#update_persisted_channel(OutPoint,ChannelMonitorUpdate,ChannelMonitor,MonitorUpdateId)>update_persisted_channel</a>(<a href=OutPoint.html>OutPoint</a> channel_id, @<a href=https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nullable.html>Nullable</a>() <a href=ChannelMonitorUpdate.html>ChannelMonitorUpdate</a> update, <a href=ChannelMonitor.html>ChannelMonitor</a> data, <a href=MonitorUpdateId.html>MonitorUpdateId</a> update_id)</pre>
                                        <div class="block"><p>Update one channel's data. The provided [`ChannelMonitor`] has already applied the given update. Note that on every update, you **must** persist either the [`ChannelMonitorUpdate`] or the updated monitor itself to disk/backups. See the [`Persist`] trait documentation for more details. During blockchain synchronization operations, this may be called with no [`ChannelMonitorUpdate`], in which case the full [`ChannelMonitor`] needs to be persisted. Note that after the full [`ChannelMonitor`] is persisted any previous [`ChannelMonitorUpdate`]s which were persisted should be discarded - they can no longer be applied to the persisted [`ChannelMonitor`] as they were already applied. If an implementer chooses to persist the updates only, they need to make sure that all the updates are applied to the `ChannelMonitors` *before the set of channel monitors is given to the `ChannelManager` deserialization routine. See [`ChannelMonitor::update_monitor`] for applying a monitor update to a monitor. If full `ChannelMonitors` are persisted, then there is no need to persist individual updates. Note that there could be a performance tradeoff between persisting complete channel monitors on every update vs. persisting only updates and applying them in batches. The size of each monitor grows `O(number of state updates)` whereas updates are small and `O(1)`. The `update_id` is used to identify this call to [`ChainMonitor::channel_monitor_updated`], if you return [`ChannelMonitorUpdateErr::TemporaryFailure`]. See [`Writeable::write`] on [`ChannelMonitor`] for writing out a `ChannelMonitor`, [`Writeable::write`] on [`ChannelMonitorUpdate`] for writing out an update, and [`ChannelMonitorUpdateErr`] for requirements when returning errors. [`Writeable::write`]: crate::util::ser::Writeable::write Note that update (or a relevant inner pointer) may be NULL or all-0s to represent None</p></div>
                                        
                                        <!-- TODO missing return annotation -->
                                    </li>
                                </ul>
                                
                            </li>
                        </ul>
                    </section>
                    
                </li>
            </ul>
        </div>
    </div>
</main>
<footer role="contentinfo">
    <nav role="navigation">
        <!-- ======= START OF BOTTOM NAVBAR ====== -->
        <div class="bottomNav"><a id="navbar.bottom">
            <!--   -->
        </a>
            <div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a>
            </div>
            <a id="navbar.bottom.firstrow">
                <!--   -->
            </a>
            <ul class="navList" title="Navigation">
    <li><a href="../../../index.html">Overview</a></li>
    
    <li><a href="package-summary.html">Package</a></li>
    
    <li class="navBarCell1Rev">Class</li>
    
    <li><a href="package-tree.html">Tree</a></li>
    
    <li><a href="../../../deprecated.html">Deprecated</a></li>
    <li><a href="../../../index-files/index-1.html">Index</a></li>
    <li>Help</li>
</ul></div>
        <a id="skip.navbar.bottom">
            <!--   -->
        </a>
        <div class="subNav">
<ul class="navList" id="allclasses_navbar_top" style="display: block;">
    <li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div><!-- ======== END OF BOTTOM NAVBAR ======= -->
    </nav>
</footer><ul class="ui-autocomplete ui-front ui-menu ui-widget ui-widget-content" id="ui-id-1" tabindex="0"
    style="display: none;"></ul>
<span role="status" aria-live="assertive" aria-relevant="additions" class="ui-helper-hidden-accessible"></span>
</body>
</html>
